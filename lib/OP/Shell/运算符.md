# shell运算符
<!-- toc -->

Shell 和其他编程语言一样，支持多种运算符，包括：
* 算数运算符
* 关系运算符
* 布尔运算符
* 字符串运算符
* 文件测试运算符

原生bash不支持简单的数学运算，但是可以通过其他命令来实现，例如 `awk` 和 `expr`，expr 最常用。

`expr` 是一款表达式计算工具，使用它能完成表达式的求值操作。

例如，两个数相加(注意使用的是`反引号`, 而不是单引号)

```js
// 达式和运算符之间要有空格
val=`expr 2 + 2`    
echo "两数之和为: $val"  // 两数之和为: 4

// 运算符 * 要转义
val=`expr 2 \* 2`   // val=4
// 在MAC中shell的 expr 语法是：$((表达式))，此时可以不用转义
val=$((2 * 2))    // val=4

// 条件表达式要放在方括号之间，并且要有空格
if [ $a == $b ]
```

### 算数运算符

```js
a=10
b=20

// 简单数学运算
`expr $a + $b`    // + => 30
`expr $a - $b`    // - => -10
`expr $a \* $b`   // * => 200
`expr $a / $b`    // / => 0（结果是整数，小数的部分会舍弃）
`expr $a % $b`    // 取余 => 0
// 其他运算
a = $b            // 赋值
[ $a == $b ]      // 是否相等 => false   
[ $a != $b ]      // 是否不等 => true
```

### 关系算符

关系运算符只支持数字，不支持字符串，除非字符串的值是数字。

```js
a=10
b=20

// 条件表达式要放在方括号之间，并且要有空格
[ $a -eq $b ]   // 是否相等 => false
[ $a -ne $b ]   // 是否不等 => true
[ $a -gt $b ]   // 是否a>b => false
[ $a -lt $b ]   // 是否a<b => true
[ $a -ge $b ]   // 是否a>=b => false
[ $a -le $b ]   // 是否a<=b => true
```

### 布尔运算符

```js
a=10
b=20
c=10

// 条件表达式要放在方括号之间，并且要有空格
[ !a ]   // 非 => true
[ $a == $b -o $a != $c  ]   // or => true
[ $a == $b -a $a != $c  ]   // and => false
```

### 逻辑运算符

```js
// && 亦可以用来连接命令（不用折行）
a=10 && b=20 && c=10

// 条件表达式要放在方括号之间，并且要有空格
[ $a == $b || $a != $c  ]   // or => true
[ $a == $b && $a != $c  ]   // and => false
```

### 字符串运算符

```js
// && 亦可以用来连接命令（不用折行）
a=abc && b=efg

// 条件表达式要放在方括号之间，并且要有空格
[ -z $a ]  // 检测字符创长度是否为为0 => false
[ -n $a ]  // 检测字符创长度是否为不为0 => true
[ $a ]     // 检测字符创长度是否为不为0 => true
```

`-z` 和 `-n` 是从逻辑上检测字符串是否为空，看个示例：

```js
a='  '      // $a 判断为0； -n、-z 判断不为0

// 结果输出: 2  
if [ $a ]     
then
  echo a is empty       // 不为0
else
  echo ${#a}            // 为0
fi

// 结果输出: a is empty
if [ -n $a ]
then
  echo a is empty     // 不为0
else
  echo ${#a}          // 为0
fi
```

### 文件测试运算符

用于检测 Unix 文件的各种属性。

```js
[ -r $file ]  // 是否可读 => true
[ -w $file ]  // 是否可写 => true
[ -x $file ]  // 是否可执行 => true
[ -s $file ]  // 文件大小是否大于0 => true
[ -e $file ]  // 文件/目录是否存在 => true
[ -b $file ]  // 是否是块设备文件 => false
[ -c $file ]  // 否是字符设备文件 => false
[ -d $file ]  // 是否是目录 => false
[ -f $file ]  // 是否是普通文件 => true
[ -g $file ]  // 是否设置了 SGID 位 => false
[ -u $file ]  // 否设置了 SUID 位 => false
[ -k $file ]  // 是否设置了粘着位 => false
[ -p $file ]  // 是否是有名管道 => false

```
